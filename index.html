<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Badminton Steuerung</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            font-family: Arial, sans-serif;
        }
        
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        
        h1 {
            text-align: center;
            color: #1f2937;
            margin-bottom: 30px;
            font-size: 32px;
        }
        
        .team-box {
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
        }
        
        .team1-box {
            background: #f0fdf4;
            border: 3px solid #4ade80;
        }
        
        .team2-box {
            background: #fef2f2;
            border: 3px solid #f87171;
        }
        
        .team-name {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .team1-box .team-name {
            color: #166534;
        }
        
        .team2-box .team-name {
            color: #991b1b;
        }
        
        .team-name input {
            width: 100%;
            font-size: 24px;
            font-weight: bold;
            padding: 10px;
            border-radius: 8px;
            border: 2px solid currentColor;
        }
        
        .score-display {
            font-size: 64px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .team1-box .score-display {
            color: #16a34a;
        }
        
        .team2-box .score-display {
            color: #dc2626;
        }
        
        .button-row {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        button {
            flex: 1;
            padding: 20px;
            font-size: 24px;
            font-weight: bold;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.1s;
        }
        
        button:active {
            transform: scale(0.95);
        }
        
        .btn-plus-team1 {
            background: #4ade80;
        }
        
        .btn-plus-team2 {
            background: #f87171;
        }
        
        .btn-minus {
            background: #dc2626;
        }
        
        .sets-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px;
            background: white;
            border-radius: 8px;
        }
        
        .sets-label {
            font-size: 18px;
            font-weight: bold;
        }
        
        .sets-buttons {
            display: flex;
            gap: 5px;
        }
        
        .sets-buttons button {
            padding: 8px 15px;
            font-size: 16px;
            border-radius: 6px;
        }
        
        .btn-set-plus-team1 {
            background: #22c55e;
        }
        
        .btn-set-plus-team2 {
            background: #f87171;
        }
        
        .btn-set-minus {
            background: #ef4444;
        }
        
        .control-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .control-buttons button {
            font-size: 16px;
            padding: 15px;
        }
        
        .btn-edit {
            background: #6b7280;
        }
        
        .btn-edit.active {
            background: #3b82f6;
        }
        
        .btn-reset {
            background: #f59e0b;
        }
        
        .btn-reset-all {
            background: #dc2626;
            width: 100%;
            margin-top: 10px;
        }
        
        .info-box {
            margin-top: 30px;
            padding: 20px;
            background: #f3f4f6;
            border-radius: 10px;
            font-size: 14px;
            color: #4b5563;
        }
        
        .info-box strong {
            display: block;
            margin-bottom: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üè∏ Badminton Scoreboard</h1>
        
        <!-- Team 1 -->
        <div class="team-box team1-box">
            <div class="team-name">
                <span id="team1-name-display">Team 1</span>
                <input type="text" id="team1-name-input" style="display: none;" value="Team 1">
            </div>
            <div class="score-display" id="team1-score">0</div>
            <div class="button-row">
                <button class="btn-plus-team1" onclick="updateScore('team1', 1)">+1</button>
                <button class="btn-minus" onclick="updateScore('team1', -1)">-1</button>
            </div>
            <div class="sets-row">
                <span class="sets-label">S√§tze: <span id="team1-sets">0</span></span>
                <div class="sets-buttons">
                    <button class="btn-set-plus-team1" onclick="updateSet('team1', 1)">+</button>
                    <button class="btn-set-minus" onclick="updateSet('team1', -1)">-</button>
                </div>
            </div>
        </div>
        
        <!-- Team 2 -->
        <div class="team-box team2-box">
            <div class="team-name">
                <span id="team2-name-display">Team 2</span>
                <input type="text" id="team2-name-input" style="display: none;" value="Team 2">
            </div>
            <div class="score-display" id="team2-score">0</div>
            <div class="button-row">
                <button class="btn-plus-team2" onclick="updateScore('team2', 1)">+1</button>
                <button class="btn-minus" onclick="updateScore('team2', -1)">-1</button>
            </div>
            <div class="sets-row">
                <span class="sets-label">S√§tze: <span id="team2-sets">0</span></span>
                <div class="sets-buttons">
                    <button class="btn-set-plus-team2" onclick="updateSet('team2', 1)">+</button>
                    <button class="btn-set-minus" onclick="updateSet('team2', -1)">-</button>
                </div>
            </div>
        </div>
        
        <!-- Steuerungsbuttons -->
        <div class="control-buttons">
            <button class="btn-edit" id="edit-btn" onclick="toggleEditMode()">‚úèÔ∏è Namen √§ndern</button>
            <button class="btn-reset" onclick="resetGame()">üîÑ Punkte zur√ºcksetzen</button>
        </div>
        <button class="btn-reset-all" onclick="resetAll()">üóëÔ∏è Alles zur√ºcksetzen</button>
        
        <div class="info-box">
            <strong>‚ÑπÔ∏è Hinweis:</strong>
            Die Daten werden automatisch synchronisiert. √ñffne das Overlay in einem anderen Browser-Tab oder Ger√§t, um die Anzeige zu sehen.
        </div>
    </div>

    <script>
        // Storage API
        const storage = {
            async get(key, shared = false) {
                const response = await fetch('https://storage.googleapis.com/clai-extension-artifacts-prod/artifact-storage/get', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ key, shared })
                });
                if (!response.ok) throw new Error('Key not found');
                return await response.json();
            },
            async set(key, value, shared = false) {
                const response = await fetch('https://storage.googleapis.com/clai-extension-artifacts-prod/artifact-storage/set', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ key, value, shared })
                });
                if (!response.ok) throw new Error('Failed to save');
                return await response.json();
            }
        };

        // Spieldaten
        let gameData = {
            scores: { team1: 0, team2: 0 },
            names: { team1: 'Team 1', team2: 'Team 2' },
            sets: { team1: 0, team2: 0 }
        };

        let editMode = false;

        // Daten laden
        async function loadData() {
            try {
                const result = await storage.get('badminton-game', true);
                gameData = JSON.parse(result.value);
                updateDisplay();
            } catch (error) {
                console.log('Initialisiere neue Spieldaten');
            }
        }

        // Daten speichern
        async function saveData() {
            try {
                await storage.set('badminton-game', JSON.stringify(gameData), true);
            } catch (error) {
                console.error('Fehler beim Speichern:', error);
            }
        }

        // Anzeige aktualisieren
        function updateDisplay() {
            document.getElementById('team1-score').textContent = gameData.scores.team1;
            document.getElementById('team2-score').textContent = gameData.scores.team2;
            document.getElementById('team1-sets').textContent = gameData.sets.team1;
            document.getElementById('team2-sets').textContent = gameData.sets.team2;
            document.getElementById('team1-name-display').textContent = gameData.names.team1;
            document.getElementById('team2-name-display').textContent = gameData.names.team2;
            document.getElementById('team1-name-input').value = gameData.names.team1;
            document.getElementById('team2-name-input').value = gameData.names.team2;
        }

        // Punktestand √§ndern
        function updateScore(team, delta) {
            gameData.scores[team] = Math.max(0, gameData.scores[team] + delta);
            updateDisplay();
            saveData();
        }

        // S√§tze √§ndern
        function updateSet(team, delta) {
            gameData.sets[team] = Math.max(0, gameData.sets[team] + delta);
            updateDisplay();
            saveData();
        }

        // Namen √§ndern
        function toggleEditMode() {
            editMode = !editMode;
            const btn = document.getElementById('edit-btn');
            
            if (editMode) {
                btn.textContent = '‚úì Namen fertig';
                btn.classList.add('active');
                document.getElementById('team1-name-display').style.display = 'none';
                document.getElementById('team1-name-input').style.display = 'block';
                document.getElementById('team2-name-display').style.display = 'none';
                document.getElementById('team2-name-input').style.display = 'block';
            } else {
                btn.textContent = '‚úèÔ∏è Namen √§ndern';
                btn.classList.remove('active');
                gameData.names.team1 = document.getElementById('team1-name-input').value;
                gameData.names.team2 = document.getElementById('team2-name-input').value;
                document.getElementById('team1-name-display').style.display = 'block';
                document.getElementById('team1-name-input').style.display = 'none';
                document.getElementById('team2-name-display').style.display = 'block';
                document.getElementById('team2-name-input').style.display = 'none';
                updateDisplay();
                saveData();
            }
        }

        // Spiel zur√ºcksetzen
        function resetGame() {
            if (confirm('Spiel wirklich zur√ºcksetzen?')) {
                gameData.scores = { team1: 0, team2: 0 };
                updateDisplay();
                saveData();
            }
        }

        // Alles zur√ºcksetzen
        function resetAll() {
            if (confirm('Alles (inkl. S√§tze) zur√ºcksetzen?')) {
                gameData.scores = { team1: 0, team2: 0 };
                gameData.sets = { team1: 0, team2: 0 };
                updateDisplay();
                saveData();
            }
        }

        // Initial laden
        loadData();
    </script>
</body>
</html>
