<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0">
<title>Badminton Scoreboard</title>

<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

html, body {
    width: 100vw;
    height: 100vh;
    font-family: Arial, sans-serif;
    overflow: hidden;
}

/* Vollbild-Hintergrund */
body {
    display: flex;
    background: #0f172a; /* Dunkelblau / neutral */
    color: white;
}

/* Layout */
.scoreboard {
    width: 100%;
    height: 100%;
    display: grid;
    grid-template-columns: 1fr 0.4fr 1fr;
    align-items: center;
}

/* Teams */
.team {
    text-align: center;
}

.team-name {
    font-size: 6vw;
    font-weight: bold;
    margin-bottom: 4vh;
}

.score {
    font-size: 30vw;
    font-weight: 900;
    line-height: 1;
}

/* Neutral */
.team1 {
    background: #020617;
}

.team2 {
    background: #020617;
}

/* Führend */
.leading {
    background: #14532d !important; /* grün */
}

/* Zurückliegend */
.trailing {
    background: #7f1d1d !important; /* rot */
}

/* Mitte */
.middle {
    background: #020617;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}

.divider {
    font-size: 10vw;
    font-weight: bold;
    opacity: 0.7;
}

.sets {
    margin-top: 4vh;
    font-size: 6vw;
    font-weight: bold;
}

.sets-label {
    margin-top: 2vh;
    font-size: 2.5vw;
    letter-spacing: 0.4vw;
    opacity: 0.7;
}
</style>
</head>

<body>

<div class="scoreboard">

    <div class="team team1">
        <div class="team-name" id="team1-name">Team 1</div>
        <div class="score" id="team1-score">0</div>
    </div>

    <div class="middle">
        <div class="divider">:</div>
        <div class="sets">
            <span id="team1-sets">0</span> : <span id="team2-sets">0</span>
        </div>
        <div class="sets-label">SÄTZE</div>
    </div>

    <div class="team team2">
        <div class="team-name" id="team2-name">Team 2</div>
        <div class="score" id="team2-score">0</div>
    </div>

</div>

<script type="module">
import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
import { getDatabase, ref, onValue, get } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';

const firebaseConfig = {
  apiKey: "AIzaSyBZnFI0Vt5J2CeFF8C6YNWNHK7pc-nxbVQ",
  authDomain: "badmintonstreamoverlay.firebaseapp.com",
  databaseURL: "https://badmintonstreamoverlay-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "badmintonstreamoverlay",
  storageBucket: "badmintonstreamoverlay.firebasestorage.app",
  messagingSenderId: "865072634738",
  appId: "1:865072634738:web:b1683b7b8d310f2221dbeb"
};

const app = initializeApp(firebaseConfig);
const database = getDatabase(app);
const gameRef = ref(database, 'badminton-game');

const elements = {
    team1Name: document.getElementById('team1-name'),
    team1Score: document.getElementById('team1-score'),
    team1Sets: document.getElementById('team1-sets'),
    team2Name: document.getElementById('team2-name'),
    team2Score: document.getElementById('team2-score'),
    team2Sets: document.getElementById('team2-sets')
};

get(gameRef).then(snapshot => {
    if (snapshot.exists()) updateDisplay(snapshot.val());
});

onValue(gameRef, snapshot => {
    if (snapshot.exists()) updateDisplay(snapshot.val());
});

function updateDisplay(data) {
    const t1Score = data.scores?.team1 || 0;
    const t2Score = data.scores?.team2 || 0;

    const t1Sets = data.sets?.team1 || 0;
    const t2Sets = data.sets?.team2 || 0;

    elements.team1Name.textContent = data.names?.team1 || 'Team 1';
    elements.team1Score.textContent = t1Score;
    elements.team1Sets.textContent = t1Sets;

    elements.team2Name.textContent = data.names?.team2 || 'Team 2';
    elements.team2Score.textContent = t2Score;
    elements.team2Sets.textContent = t2Sets;

    /* Klassen zurücksetzen */
    const team1El = document.querySelector('.team1');
    const team2El = document.querySelector('.team2');

    team1El.classList.remove('leading', 'trailing');
    team2El.classList.remove('leading', 'trailing');

    /* Wer führt? */
    if (t1Score > t2Score) {
        team1El.classList.add('leading');
        team2El.classList.add('trailing');
    } else if (t2Score > t1Score) {
        team2El.classList.add('leading');
        team1El.classList.add('trailing');
    }
}

</script>

</body>
</html>
